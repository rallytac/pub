<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
		<meta http-equiv="X-UA-Compatible" content="IE=9"/>
		<meta name="generator" content="Doxygen 1.8.18"/>
		<meta name="viewport" content="width=device-width, initial-scale=1"/>
		<title>Engage Engine API: socks  &lt;a href=&quot;https://travis-ci.org/JoshGlazebrook/socks&quot;&gt;&lt;img src=&quot;https://travis-ci.org/JoshGlazebrook/socks.svg?branch=master&quot; alt=&quot;Build Status&quot;/&gt;&lt;/a&gt;  &lt;a href=&quot;https://coveralls.io/github/JoshGlazebrook/socks?branch=v2&quot;&gt;&lt;img src=&quot;https://coveralls.io/repos/github/JoshGlazebrook/socks/badge.svg?branch=master&quot; alt=&quot;Coverage Status&quot;/&gt;&lt;/a&gt;</title>
		<link href="tabs.css" rel="stylesheet" type="text/css"/>
		<script type="text/javascript" src="jquery.js"></script>
		<script type="text/javascript" src="dynsections.js"></script>
		<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
		<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
		<link href="doxygen.css" rel="stylesheet" type="text/css" />
		<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="custom_dark_theme.css" rel="stylesheet" type="text/css"/>
	</head>
	<body>
	<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
		<div id="titlearea">
			<table cellspacing="0" cellpadding="0">
				<tbody>
					<tr style="height: 56px;">
						<td id="projectalign" style="padding-left: 0.5em;">
							<div id="projectname">Engage Engine API
								&#160;<span id="projectnumber">1.221.9059</span>
							</div>
						</td>
					</tr>
				</tbody>
			</table>
		</div>
		<!-- end header part --><!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_nodejs_node_modules_socks__r_e_a_d_m_e.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">socks <a href="https://travis-ci.org/JoshGlazebrook/socks"><img src="https://travis-ci.org/JoshGlazebrook/socks.svg?branch=master" alt="Build Status" style="pointer-events: none;" class="inline"/></a> <a href="https://coveralls.io/github/JoshGlazebrook/socks?branch=v2"><img src="https://coveralls.io/repos/github/JoshGlazebrook/socks/badge.svg?branch=master" alt="Coverage Status" style="pointer-events: none;" class="inline"/></a> </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Fully featured SOCKS proxy client supporting SOCKSv4, SOCKSv4a, and SOCKSv5. Includes Bind and Associate functionality.</p>
<h2><a class="anchor" id="autotoc_md1619"></a>
Features</h2>
<ul>
<li>Supports SOCKS v4, v4a, v5, and v5h protocols.</li>
<li>Supports the CONNECT, BIND, and ASSOCIATE commands.</li>
<li>Supports callbacks, promises, and events for proxy connection creation async flow control.</li>
<li>Supports proxy chaining (CONNECT only).</li>
<li>Supports user/password authentication.</li>
<li>Supports custom authentication.</li>
<li>Built in UDP frame creation &amp; parse functions.</li>
<li>Created with TypeScript, type definitions are provided.</li>
</ul>
<h2><a class="anchor" id="autotoc_md1620"></a>
Requirements</h2>
<ul>
<li>Node.js v10.0+ (Please use <a href="https://github.com/JoshGlazebrook/socks/tree/82d83923ad960693d8b774cafe17443ded7ed584">v1</a> for older versions of Node.js)</li>
</ul>
<h2><a class="anchor" id="autotoc_md1621"></a>
Looking for v1?</h2>
<ul>
<li>Docs for v1 are available <a href="https://github.com/JoshGlazebrook/socks/tree/82d83923ad960693d8b774cafe17443ded7ed584">here</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md1622"></a>
Installation</h1>
<p><code>yarn add socks</code></p>
<p>or</p>
<p><code>npm install --save socks</code></p>
<h1><a class="anchor" id="autotoc_md1623"></a>
Usage</h1>
<div class="fragment"><div class="line">// TypeScript</div>
<div class="line">import { SocksClient, SocksClientOptions, SocksClientChainOptions } from &#39;socks&#39;;</div>
<div class="line"> </div>
<div class="line">// ES6 JavaScript</div>
<div class="line">import { SocksClient } from &#39;socks&#39;;</div>
<div class="line"> </div>
<div class="line">// Legacy JavaScript</div>
<div class="line">const SocksClient = require(&#39;socks&#39;).SocksClient;</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1624"></a>
Quick Start Example</h1>
<p>Connect to github.com (192.30.253.113) on port 80, using a SOCKS proxy.</p>
<div class="fragment"><div class="line">const options = {</div>
<div class="line">  proxy: {</div>
<div class="line">    host: &#39;159.203.75.200&#39;, // ipv4 or ipv6 or hostname</div>
<div class="line">    port: 1080,</div>
<div class="line">    type: 5 // Proxy version (4 or 5)</div>
<div class="line">  },</div>
<div class="line"> </div>
<div class="line">  command: &#39;connect&#39;, // SOCKS command (createConnection factory function only supports the connect command)</div>
<div class="line"> </div>
<div class="line">  destination: {</div>
<div class="line">    host: &#39;192.30.253.113&#39;, // github.com (hostname lookups are supported with SOCKS v4a and 5)</div>
<div class="line">    port: 80</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">// Async/Await</div>
<div class="line">try {</div>
<div class="line">  const info = await SocksClient.createConnection(options);</div>
<div class="line"> </div>
<div class="line">  console.log(info.socket);</div>
<div class="line">  // &lt;Socket ...&gt;  (this is a raw net.Socket that is established to the destination host through the given proxy server)</div>
<div class="line">} catch (err) {</div>
<div class="line">  // Handle errors</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">// Promises</div>
<div class="line">SocksClient.createConnection(options)</div>
<div class="line">.then(info =&gt; {</div>
<div class="line">  console.log(info.socket);</div>
<div class="line">  // &lt;Socket ...&gt;  (this is a raw net.Socket that is established to the destination host through the given proxy server)</div>
<div class="line">})</div>
<div class="line">.catch(err =&gt; {</div>
<div class="line">  // Handle errors</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">// Callbacks</div>
<div class="line">SocksClient.createConnection(options, (err, info) =&gt; {</div>
<div class="line">  if (!err) {</div>
<div class="line">    console.log(info.socket);</div>
<div class="line">    // &lt;Socket ...&gt;  (this is a raw net.Socket that is established to the destination host through the given proxy server)</div>
<div class="line">  } else {</div>
<div class="line">    // Handle errors</div>
<div class="line">  }</div>
<div class="line">});</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1625"></a>
Chaining Proxies</h1>
<p><b>Note:</b> Chaining is only supported when using the SOCKS connect command, and chaining can only be done through the special factory chaining function.</p>
<p>This example makes a proxy chain through two SOCKS proxies to ip-api.com. Once the connection to the destination is established it sends an HTTP request to get a <a class="el" href="class_j_s_o_n.html">JSON</a> response that returns ip info for the requesting ip.</p>
<div class="fragment"><div class="line">const options = {</div>
<div class="line">  destination: {</div>
<div class="line">    host: &#39;ip-api.com&#39;, // host names are supported with SOCKS v4a and SOCKS v5.</div>
<div class="line">    port: 80</div>
<div class="line">  },</div>
<div class="line">  command: &#39;connect&#39;, // Only the connect command is supported when chaining proxies.</div>
<div class="line">  proxies: [ // The chain order is the order in the proxies array, meaning the last proxy will establish a connection to the destination.</div>
<div class="line">    {</div>
<div class="line">      host: &#39;159.203.75.235&#39;, // ipv4, ipv6, or hostname</div>
<div class="line">      port: 1081,</div>
<div class="line">      type: 5</div>
<div class="line">    },</div>
<div class="line">    {</div>
<div class="line">      host: &#39;104.131.124.203&#39;, // ipv4, ipv6, or hostname</div>
<div class="line">      port: 1081,</div>
<div class="line">      type: 5</div>
<div class="line">    }</div>
<div class="line">  ]</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">// Async/Await</div>
<div class="line">try {</div>
<div class="line">  const info = await SocksClient.createConnectionChain(options);</div>
<div class="line"> </div>
<div class="line">  console.log(info.socket);</div>
<div class="line">  // &lt;Socket ...&gt;  (this is a raw net.Socket that is established to the destination host through the given proxy servers)</div>
<div class="line"> </div>
<div class="line">  console.log(info.socket.remoteAddress) // The remote address of the returned socket is the first proxy in the chain.</div>
<div class="line">  // 159.203.75.235</div>
<div class="line"> </div>
<div class="line">  info.socket.write(&#39;GET /json HTTP/1.1\nHost: ip-api.com\n\n&#39;);</div>
<div class="line">  info.socket.on(&#39;data&#39;, (data) =&gt; {</div>
<div class="line">    console.log(data.toString()); // ip-api.com sees that the last proxy in the chain (104.131.124.203) is connected to it.</div>
<div class="line">    /*</div>
<div class="line">      HTTP/1.1 200 OK</div>
<div class="line">      Access-Control-Allow-Origin: *</div>
<div class="line">      Content-Type: application/json; charset=utf-8</div>
<div class="line">      Date: Sun, 24 Dec 2017 03:47:51 GMT</div>
<div class="line">      Content-Length: 300</div>
<div class="line"> </div>
<div class="line">      {</div>
<div class="line">        &quot;as&quot;:&quot;AS14061 Digital Ocean, Inc.&quot;,</div>
<div class="line">        &quot;city&quot;:&quot;Clifton&quot;,</div>
<div class="line">        &quot;country&quot;:&quot;United States&quot;,</div>
<div class="line">        &quot;countryCode&quot;:&quot;US&quot;,</div>
<div class="line">        &quot;isp&quot;:&quot;Digital Ocean&quot;,</div>
<div class="line">        &quot;lat&quot;:40.8326,</div>
<div class="line">        &quot;lon&quot;:-74.1307,</div>
<div class="line">        &quot;org&quot;:&quot;Digital Ocean&quot;,</div>
<div class="line">        &quot;query&quot;:&quot;104.131.124.203&quot;,</div>
<div class="line">        &quot;region&quot;:&quot;NJ&quot;,</div>
<div class="line">        &quot;regionName&quot;:&quot;New Jersey&quot;,</div>
<div class="line">        &quot;status&quot;:&quot;success&quot;,</div>
<div class="line">        &quot;timezone&quot;:&quot;America/New_York&quot;,</div>
<div class="line">        &quot;zip&quot;:&quot;07014&quot;</div>
<div class="line">      }</div>
<div class="line">    */</div>
<div class="line">  });</div>
<div class="line">} catch (err) {</div>
<div class="line">  // Handle errors</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">// Promises</div>
<div class="line">SocksClient.createConnectionChain(options)</div>
<div class="line">.then(info =&gt; {</div>
<div class="line">  console.log(info.socket);</div>
<div class="line">  // &lt;Socket ...&gt;  (this is a raw net.Socket that is established to the destination host through the given proxy server)</div>
<div class="line"> </div>
<div class="line">  console.log(info.socket.remoteAddress) // The remote address of the returned socket is the first proxy in the chain.</div>
<div class="line">  // 159.203.75.235</div>
<div class="line"> </div>
<div class="line">  info.socket.write(&#39;GET /json HTTP/1.1\nHost: ip-api.com\n\n&#39;);</div>
<div class="line">  info.socket.on(&#39;data&#39;, (data) =&gt; {</div>
<div class="line">    console.log(data.toString()); // ip-api.com sees that the last proxy in the chain (104.131.124.203) is connected to it.</div>
<div class="line">    /*</div>
<div class="line">      HTTP/1.1 200 OK</div>
<div class="line">      Access-Control-Allow-Origin: *</div>
<div class="line">      Content-Type: application/json; charset=utf-8</div>
<div class="line">      Date: Sun, 24 Dec 2017 03:47:51 GMT</div>
<div class="line">      Content-Length: 300</div>
<div class="line"> </div>
<div class="line">      {</div>
<div class="line">        &quot;as&quot;:&quot;AS14061 Digital Ocean, Inc.&quot;,</div>
<div class="line">        &quot;city&quot;:&quot;Clifton&quot;,</div>
<div class="line">        &quot;country&quot;:&quot;United States&quot;,</div>
<div class="line">        &quot;countryCode&quot;:&quot;US&quot;,</div>
<div class="line">        &quot;isp&quot;:&quot;Digital Ocean&quot;,</div>
<div class="line">        &quot;lat&quot;:40.8326,</div>
<div class="line">        &quot;lon&quot;:-74.1307,</div>
<div class="line">        &quot;org&quot;:&quot;Digital Ocean&quot;,</div>
<div class="line">        &quot;query&quot;:&quot;104.131.124.203&quot;,</div>
<div class="line">        &quot;region&quot;:&quot;NJ&quot;,</div>
<div class="line">        &quot;regionName&quot;:&quot;New Jersey&quot;,</div>
<div class="line">        &quot;status&quot;:&quot;success&quot;,</div>
<div class="line">        &quot;timezone&quot;:&quot;America/New_York&quot;,</div>
<div class="line">        &quot;zip&quot;:&quot;07014&quot;</div>
<div class="line">      }</div>
<div class="line">    */</div>
<div class="line">  });</div>
<div class="line">})</div>
<div class="line">.catch(err =&gt; {</div>
<div class="line">  // Handle errors</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">// Callbacks</div>
<div class="line">SocksClient.createConnectionChain(options, (err, info) =&gt; {</div>
<div class="line">  if (!err) {</div>
<div class="line">    console.log(info.socket);</div>
<div class="line">    // &lt;Socket ...&gt;  (this is a raw net.Socket that is established to the destination host through the given proxy server)</div>
<div class="line"> </div>
<div class="line">    console.log(info.socket.remoteAddress) // The remote address of the returned socket is the first proxy in the chain.</div>
<div class="line">  // 159.203.75.235</div>
<div class="line"> </div>
<div class="line">  info.socket.write(&#39;GET /json HTTP/1.1\nHost: ip-api.com\n\n&#39;);</div>
<div class="line">  info.socket.on(&#39;data&#39;, (data) =&gt; {</div>
<div class="line">    console.log(data.toString()); // ip-api.com sees that the last proxy in the chain (104.131.124.203) is connected to it.</div>
<div class="line">    /*</div>
<div class="line">      HTTP/1.1 200 OK</div>
<div class="line">      Access-Control-Allow-Origin: *</div>
<div class="line">      Content-Type: application/json; charset=utf-8</div>
<div class="line">      Date: Sun, 24 Dec 2017 03:47:51 GMT</div>
<div class="line">      Content-Length: 300</div>
<div class="line"> </div>
<div class="line">      {</div>
<div class="line">        &quot;as&quot;:&quot;AS14061 Digital Ocean, Inc.&quot;,</div>
<div class="line">        &quot;city&quot;:&quot;Clifton&quot;,</div>
<div class="line">        &quot;country&quot;:&quot;United States&quot;,</div>
<div class="line">        &quot;countryCode&quot;:&quot;US&quot;,</div>
<div class="line">        &quot;isp&quot;:&quot;Digital Ocean&quot;,</div>
<div class="line">        &quot;lat&quot;:40.8326,</div>
<div class="line">        &quot;lon&quot;:-74.1307,</div>
<div class="line">        &quot;org&quot;:&quot;Digital Ocean&quot;,</div>
<div class="line">        &quot;query&quot;:&quot;104.131.124.203&quot;,</div>
<div class="line">        &quot;region&quot;:&quot;NJ&quot;,</div>
<div class="line">        &quot;regionName&quot;:&quot;New Jersey&quot;,</div>
<div class="line">        &quot;status&quot;:&quot;success&quot;,</div>
<div class="line">        &quot;timezone&quot;:&quot;America/New_York&quot;,</div>
<div class="line">        &quot;zip&quot;:&quot;07014&quot;</div>
<div class="line">      }</div>
<div class="line">    */</div>
<div class="line">  });</div>
<div class="line">  } else {</div>
<div class="line">    // Handle errors</div>
<div class="line">  }</div>
<div class="line">});</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1626"></a>
Bind Example (TCP Relay)</h1>
<p>When the bind command is sent to a SOCKS v4/v5 proxy server, the proxy server starts listening on a new TCP port and the proxy relays then remote host information back to the client. When another remote client connects to the proxy server on this port the SOCKS proxy sends a notification that an incoming connection has been accepted to the initial client and a full duplex stream is now established to the initial client and the client that connected to that special port.</p>
<div class="fragment"><div class="line">const options = {</div>
<div class="line">  proxy: {</div>
<div class="line">    host: &#39;159.203.75.235&#39;, // ipv4, ipv6, or hostname</div>
<div class="line">    port: 1081,</div>
<div class="line">    type: 5</div>
<div class="line">  },</div>
<div class="line"> </div>
<div class="line">  command: &#39;bind&#39;,</div>
<div class="line"> </div>
<div class="line">  // When using BIND, the destination should be the remote client that is expected to connect to the SOCKS proxy. Using 0.0.0.0 makes the Proxy accept any incoming connection on that port.</div>
<div class="line">  destination: {</div>
<div class="line">    host: &#39;0.0.0.0&#39;,</div>
<div class="line">    port: 0</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">// Creates a new SocksClient instance.</div>
<div class="line">const client = new SocksClient(options);</div>
<div class="line"> </div>
<div class="line">// When the SOCKS proxy has bound a new port and started listening, this event is fired.</div>
<div class="line">client.on(&#39;bound&#39;, info =&gt; {</div>
<div class="line">  console.log(info.remoteHost);</div>
<div class="line">  /*</div>
<div class="line">  {</div>
<div class="line">    host: &quot;159.203.75.235&quot;,</div>
<div class="line">    port: 57362</div>
<div class="line">  }</div>
<div class="line">  */</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">// When a client connects to the newly bound port on the SOCKS proxy, this event is fired.</div>
<div class="line">client.on(&#39;established&#39;, info =&gt; {</div>
<div class="line">  // info.remoteHost is the remote address of the client that connected to the SOCKS proxy.</div>
<div class="line">  console.log(info.remoteHost);</div>
<div class="line">  /*</div>
<div class="line">    host: 67.171.34.23,</div>
<div class="line">    port: 49823</div>
<div class="line">  */</div>
<div class="line"> </div>
<div class="line">  console.log(info.socket);</div>
<div class="line">  // &lt;Socket ...&gt;  (This is a raw net.Socket that is a connection between the initial client and the remote client that connected to the proxy)</div>
<div class="line"> </div>
<div class="line">  // Handle received data...</div>
<div class="line">  info.socket.on(&#39;data&#39;, data =&gt; {</div>
<div class="line">    console.log(&#39;recv&#39;, data);</div>
<div class="line">  });</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">// An error occurred trying to establish this SOCKS connection.</div>
<div class="line">client.on(&#39;error&#39;, err =&gt; {</div>
<div class="line">  console.error(err);</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">// Start connection to proxy</div>
<div class="line">client.connect();</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1627"></a>
Associate Example (UDP Relay)</h1>
<p>When the associate command is sent to a SOCKS v5 proxy server, it sets up a UDP relay that allows the client to send UDP packets to a remote host through the proxy server, and also receive UDP packet responses back through the proxy server.</p>
<div class="fragment"><div class="line">const options = {</div>
<div class="line">  proxy: {</div>
<div class="line">    host: &#39;159.203.75.235&#39;, // ipv4, ipv6, or hostname</div>
<div class="line">    port: 1081,</div>
<div class="line">    type: 5</div>
<div class="line">  },</div>
<div class="line"> </div>
<div class="line">  command: &#39;associate&#39;,</div>
<div class="line"> </div>
<div class="line">  // When using associate, the destination should be the remote client that is expected to send UDP packets to the proxy server to be forwarded. This should be your local ip, or optionally the wildcard address (0.0.0.0)  UDP Client &lt;-&gt; Proxy &lt;-&gt; UDP Client</div>
<div class="line">  destination: {</div>
<div class="line">    host: &#39;0.0.0.0&#39;,</div>
<div class="line">    port: 0</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">// Create a local UDP socket for sending packets to the proxy.</div>
<div class="line">const udpSocket = dgram.createSocket(&#39;udp4&#39;);</div>
<div class="line">udpSocket.bind();</div>
<div class="line"> </div>
<div class="line">// Listen for incoming UDP packets from the proxy server.</div>
<div class="line">udpSocket.on(&#39;message&#39;, (message, rinfo) =&gt; {</div>
<div class="line">  console.log(SocksClient.parseUDPFrame(message));</div>
<div class="line">  /*</div>
<div class="line">  { frameNumber: 0,</div>
<div class="line">    remoteHost: { host: &#39;165.227.108.231&#39;, port: 4444 }, // The remote host that replied with a UDP packet</div>
<div class="line">    data: &lt;Buffer 74 65 73 74 0a&gt; // The data</div>
<div class="line">  }</div>
<div class="line">  */</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">let client = new SocksClient(associateOptions);</div>
<div class="line"> </div>
<div class="line">// When the UDP relay is established, this event is fired and includes the UDP relay port to send data to on the proxy server.</div>
<div class="line">client.on(&#39;established&#39;, info =&gt; {</div>
<div class="line">  console.log(info.remoteHost);</div>
<div class="line">  /*</div>
<div class="line">    {</div>
<div class="line">      host: &#39;159.203.75.235&#39;,</div>
<div class="line">      port: 44711</div>
<div class="line">    }</div>
<div class="line">  */</div>
<div class="line"> </div>
<div class="line">  // Send &#39;hello&#39; to 165.227.108.231:4444</div>
<div class="line">  const packet = SocksClient.createUDPFrame({</div>
<div class="line">    remoteHost: { host: &#39;165.227.108.231&#39;, port: 4444 },</div>
<div class="line">    data: Buffer.from(line)</div>
<div class="line">  });</div>
<div class="line">  udpSocket.send(packet, info.remoteHost.port, info.remoteHost.host);</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">// Start connection</div>
<div class="line">client.connect();</div>
</div><!-- fragment --><p><b>Note:</b> The associate TCP connection to the proxy must remain open for the UDP relay to work.</p>
<h1><a class="anchor" id="autotoc_md1628"></a>
Additional Examples</h1>
<p><a class="el" href="md_nodejs_node_modules_socks_docs_index.html">Documentation</a></p>
<h1><a class="anchor" id="autotoc_md1629"></a>
Migrating from v1</h1>
<p>Looking for a guide to migrate from v1? Look <a class="el" href="md_nodejs_node_modules_socks_docs_migrating_from_v1.html">here</a></p>
<h1><a class="anchor" id="autotoc_md1630"></a>
Api Reference:</h1>
<p><b>Note:</b> socks includes full TypeScript definitions. These can even be used without using TypeScript as most IDEs (such as VS Code) will use these type definition files for auto completion intellisense even in JavaScript files.</p>
<ul>
<li>Class: SocksClient<ul>
<li><a href="#new-socksclientoptions">new SocksClient(options[, callback])</a></li>
<li><a href="#class-method-socksclientcreateconnectionoptions-callback">Class Method: SocksClient.createConnection(options[, callback])</a></li>
<li><a href="#class-method-socksclientcreateconnectionchainoptions-callback">Class Method: SocksClient.createConnectionChain(options[, callback])</a></li>
<li><a href="#class-method-socksclientcreateudpframedetails">Class Method: SocksClient.createUDPFrame(options)</a></li>
<li><a href="#class-method-socksclientparseudpframedata">Class Method: SocksClient.parseUDPFrame(data)</a></li>
<li><a href="#event-error">Event: 'error'</a></li>
<li><a href="#event-bound">Event: 'bound'</a></li>
<li><a href="#event-established">Event: 'established'</a></li>
<li><a href="#clientconnect">client.connect()</a></li>
<li><a href="#clientconnect">client.socksClientOptions</a></li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1631"></a>
SocksClient</h2>
<p>SocksClient establishes SOCKS proxy connections to remote destination hosts. These proxy connections are fully transparent to the server and once established act as full duplex streams. SOCKS v4, v4a, v5, and v5h are supported, as well as the connect, bind, and associate commands.</p>
<p>SocksClient supports creating connections using callbacks, promises, and async/await flow control using two static factory functions createConnection and createConnectionChain. It also internally extends EventEmitter which results in allowing event handling based async flow control.</p>
<p><b>SOCKS Compatibility Table</b></p>
<p>Note: When using 4a please specify type: 4, and when using 5h please specify type 5.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Socks Version </th><th class="markdownTableHeadCenter">TCP </th><th class="markdownTableHeadCenter">UDP </th><th class="markdownTableHeadCenter">IPv4 </th><th class="markdownTableHeadCenter">IPv6 </th><th class="markdownTableHeadCenter">Hostname  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">SOCKS v4 </td><td class="markdownTableBodyCenter">✅ </td><td class="markdownTableBodyCenter">❌ </td><td class="markdownTableBodyCenter">✅ </td><td class="markdownTableBodyCenter">❌ </td><td class="markdownTableBodyCenter">❌  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">SOCKS v4a </td><td class="markdownTableBodyCenter">✅ </td><td class="markdownTableBodyCenter">❌ </td><td class="markdownTableBodyCenter">✅ </td><td class="markdownTableBodyCenter">❌ </td><td class="markdownTableBodyCenter">✅  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">SOCKS v5 (includes v5h) </td><td class="markdownTableBodyCenter">✅ </td><td class="markdownTableBodyCenter">✅ </td><td class="markdownTableBodyCenter">✅ </td><td class="markdownTableBodyCenter">✅ </td><td class="markdownTableBodyCenter">✅  </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1632"></a>
new SocksClient(options)</h2>
<ul>
<li><code>options</code> {SocksClientOptions} - An object describing the SOCKS proxy to use, the command to send and establish, and the destination host to connect to.</li>
</ul>
<h2><a class="anchor" id="autotoc_md1633"></a>
SocksClientOptions</h2>
<div class="fragment"><div class="line">{</div>
<div class="line">  proxy: {</div>
<div class="line">    host: &#39;159.203.75.200&#39;, // ipv4, ipv6, or hostname</div>
<div class="line">    port: 1080,</div>
<div class="line">    type: 5 // Proxy version (4 or 5). For v4a use 4, for v5h use 5.</div>
<div class="line"> </div>
<div class="line">    // Optional fields</div>
<div class="line">    userId: &#39;some username&#39;, // Used for SOCKS4 userId auth, and SOCKS5 user/pass auth in conjunction with password.</div>
<div class="line">    password: &#39;some password&#39;, // Used in conjunction with userId for user/pass auth for SOCKS5 proxies.</div>
<div class="line">    custom_auth_method: 0x80,  // If using a custom auth method, specify the type here. If this is set, ALL other custom_auth_*** options must be set as well.</div>
<div class="line">    custom_auth_request_handler: async () =&gt;. {</div>
<div class="line">      // This will be called when it&#39;s time to send the custom auth handshake. You must return a Buffer containing the data to send as your authentication.</div>
<div class="line">      return Buffer.from([0x01,0x02,0x03]);</div>
<div class="line">    },</div>
<div class="line">    // This is the expected size (bytes) of the custom auth response from the proxy server.</div>
<div class="line">    custom_auth_response_size: 2,</div>
<div class="line">    // This is called when the auth response is received. The received packet is passed in as a Buffer, and you must return a boolean indicating the response from the server said your custom auth was successful or failed.</div>
<div class="line">    custom_auth_response_handler: async (data) =&gt; {</div>
<div class="line">      return data[1] === 0x00;</div>
<div class="line">    }</div>
<div class="line">  },</div>
<div class="line"> </div>
<div class="line">  command: &#39;connect&#39;, // connect, bind, associate</div>
<div class="line"> </div>
<div class="line">  destination: {</div>
<div class="line">    host: &#39;192.30.253.113&#39;, // ipv4, ipv6, hostname. Hostnames work with v4a and v5.</div>
<div class="line">    port: 80</div>
<div class="line">  },</div>
<div class="line"> </div>
<div class="line">  // Optional fields</div>
<div class="line">  timeout: 30000, // How long to wait to establish a proxy connection. (defaults to 30 seconds)</div>
<div class="line"> </div>
<div class="line">  set_tcp_nodelay: true // If true, will turn on the underlying sockets TCP_NODELAY option.</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1634"></a>
Class Method: SocksClient.createConnection(options[, callback])</h2>
<ul>
<li><code>options</code> { SocksClientOptions } - An object describing the SOCKS proxy to use, the command to send and establish, and the destination host to connect to.</li>
<li><code>callback</code> { Function } - Optional callback function that is called when the proxy connection is established, or an error occurs.</li>
<li><code>returns</code> { Promise } - A Promise is returned that is resolved when the proxy connection is established, or rejected when an error occurs.</li>
</ul>
<p>Creates a new proxy connection through the given proxy to the given destination host. This factory function supports callbacks and promises for async flow control.</p>
<p><b>Note:</b> If a callback function is provided, the promise will always resolve regardless of an error occurring. Please be sure to exclusively use either promises or callbacks when using this factory function.</p>
<div class="fragment"><div class="line">const options = {</div>
<div class="line">  proxy: {</div>
<div class="line">    host: &#39;159.203.75.200&#39;, // ipv4, ipv6, or hostname</div>
<div class="line">    port: 1080,</div>
<div class="line">    type: 5 // Proxy version (4 or 5)</div>
<div class="line">  },</div>
<div class="line"> </div>
<div class="line">  command: &#39;connect&#39;, // connect, bind, associate</div>
<div class="line"> </div>
<div class="line">  destination: {</div>
<div class="line">    host: &#39;192.30.253.113&#39;, // ipv4, ipv6, or hostname</div>
<div class="line">    port: 80</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">// Await/Async (uses a Promise)</div>
<div class="line">try {</div>
<div class="line">  const info = await SocksClient.createConnection(options);</div>
<div class="line">  console.log(info);</div>
<div class="line">  /*</div>
<div class="line">  {</div>
<div class="line">    socket: &lt;Socket ...&gt;,  // Raw net.Socket</div>
<div class="line">  }</div>
<div class="line">  */</div>
<div class="line">  / &lt;Socket ...&gt;  (this is a raw net.Socket that is established to the destination host through the given proxy server)</div>
<div class="line"> </div>
<div class="line">} catch (err) {</div>
<div class="line">  // Handle error...</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">// Promise</div>
<div class="line">SocksClient.createConnection(options)</div>
<div class="line">.then(info =&gt; {</div>
<div class="line">  console.log(info);</div>
<div class="line">  /*</div>
<div class="line">  {</div>
<div class="line">    socket: &lt;Socket ...&gt;,  // Raw net.Socket</div>
<div class="line">  }</div>
<div class="line">  */</div>
<div class="line">})</div>
<div class="line">.catch(err =&gt; {</div>
<div class="line">  // Handle error...</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">// Callback</div>
<div class="line">SocksClient.createConnection(options, (err, info) =&gt; {</div>
<div class="line">  if (!err) {</div>
<div class="line">    console.log(info);</div>
<div class="line">  /*</div>
<div class="line">  {</div>
<div class="line">    socket: &lt;Socket ...&gt;,  // Raw net.Socket</div>
<div class="line">  }</div>
<div class="line">  */</div>
<div class="line">  } else {</div>
<div class="line">    // Handle error...</div>
<div class="line">  }</div>
<div class="line">});</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1635"></a>
Class Method: SocksClient.createConnectionChain(options[, callback])</h2>
<ul>
<li><code>options</code> { SocksClientChainOptions } - An object describing a list of SOCKS proxies to use, the command to send and establish, and the destination host to connect to.</li>
<li><code>callback</code> { Function } - Optional callback function that is called when the proxy connection chain is established, or an error occurs.</li>
<li><code>returns</code> { Promise } - A Promise is returned that is resolved when the proxy connection chain is established, or rejected when an error occurs.</li>
</ul>
<p>Creates a new proxy connection chain through a list of at least two SOCKS proxies to the given destination host. This factory method supports callbacks and promises for async flow control.</p>
<p><b>Note:</b> If a callback function is provided, the promise will always resolve regardless of an error occurring. Please be sure to exclusively use either promises or callbacks when using this factory function.</p>
<p><b>Note:</b> At least two proxies must be provided for the chain to be established.</p>
<div class="fragment"><div class="line">const options = {</div>
<div class="line">  proxies: [ // The chain order is the order in the proxies array, meaning the last proxy will establish a connection to the destination.</div>
<div class="line">    {</div>
<div class="line">      host: &#39;159.203.75.235&#39;, // ipv4, ipv6, or hostname</div>
<div class="line">      port: 1081,</div>
<div class="line">      type: 5</div>
<div class="line">    },</div>
<div class="line">    {</div>
<div class="line">      host: &#39;104.131.124.203&#39;, // ipv4, ipv6, or hostname</div>
<div class="line">      port: 1081,</div>
<div class="line">      type: 5</div>
<div class="line">    }</div>
<div class="line">  ]</div>
<div class="line"> </div>
<div class="line">  command: &#39;connect&#39;, // Only connect is supported in chaining mode.</div>
<div class="line"> </div>
<div class="line">  destination: {</div>
<div class="line">    host: &#39;192.30.253.113&#39;, // ipv4, ipv6, hostname</div>
<div class="line">    port: 80</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1636"></a>
Class Method: SocksClient.createUDPFrame(details)</h2>
<ul>
<li><code>details</code> { SocksUDPFrameDetails } - An object containing the remote host, frame number, and frame data to use when creating a SOCKS UDP frame packet.</li>
<li><code>returns</code> { Buffer } - A Buffer containing all of the UDP frame data.</li>
</ul>
<p>Creates a SOCKS UDP frame relay packet that is sent and received via a SOCKS proxy when using the associate command for UDP packet forwarding.</p>
<p><b>SocksUDPFrameDetails</b></p>
<div class="fragment"><div class="line">{</div>
<div class="line">  frameNumber: 0, // The frame number (used for breaking up larger packets)</div>
<div class="line"> </div>
<div class="line">  remoteHost: { // The remote host to have the proxy send data to, or the remote host that send this data.</div>
<div class="line">    host: &#39;1.2.3.4&#39;,</div>
<div class="line">    port: 1234</div>
<div class="line">  },</div>
<div class="line"> </div>
<div class="line">  data: &lt;Buffer 01 02 03 04...&gt; // A Buffer instance of data to include in the packet (actual data sent to the remote host)</div>
<div class="line">}</div>
<div class="line">interface SocksUDPFrameDetails {</div>
<div class="line">  // The frame number of the packet.</div>
<div class="line">  frameNumber?: number;</div>
<div class="line"> </div>
<div class="line">  // The remote host.</div>
<div class="line">  remoteHost: SocksRemoteHost;</div>
<div class="line"> </div>
<div class="line">  // The packet data.</div>
<div class="line">  data: Buffer;</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1637"></a>
Class Method: SocksClient.parseUDPFrame(data)</h2>
<ul>
<li><code>data</code> { Buffer } - A Buffer instance containing SOCKS UDP frame data to parse.</li>
<li><code>returns</code> { SocksUDPFrameDetails } - An object containing the remote host, frame number, and frame data of the SOCKS UDP frame.</li>
</ul>
<div class="fragment"><div class="line">const frame = SocksClient.parseUDPFrame(data);</div>
<div class="line">console.log(frame);</div>
<div class="line">/*</div>
<div class="line">{</div>
<div class="line">  frameNumber: 0,</div>
<div class="line">  remoteHost: {</div>
<div class="line">    host: &#39;1.2.3.4&#39;,</div>
<div class="line">    port: 1234</div>
<div class="line">  },</div>
<div class="line">  data: &lt;Buffer 01 02 03 04 ...&gt;</div>
<div class="line">}</div>
<div class="line">*/</div>
</div><!-- fragment --><p>Parses a Buffer instance and returns the parsed SocksUDPFrameDetails object.</p>
<h1><a class="anchor" id="autotoc_md1638"></a>
Event: 'error'</h1>
<ul>
<li><code>err</code> { SocksClientError } - An Error object containing an error message and the original SocksClientOptions.</li>
</ul>
<p>This event is emitted if an error occurs when trying to establish the proxy connection.</p>
<h1><a class="anchor" id="autotoc_md1639"></a>
Event: 'bound'</h1>
<ul>
<li><code>info</code> { SocksClientBoundEvent } An object containing a Socket and SocksRemoteHost info.</li>
</ul>
<p>This event is emitted when using the BIND command on a remote SOCKS proxy server. This event indicates the proxy server is now listening for incoming connections on a specified port.</p>
<p><b>SocksClientBoundEvent</b> </p><div class="fragment"><div class="line">{</div>
<div class="line">  socket: net.Socket, // The underlying raw Socket</div>
<div class="line">  remoteHost: {</div>
<div class="line">    host: &#39;1.2.3.4&#39;, // The remote host that is listening (usually the proxy itself)</div>
<div class="line">    port: 4444 // The remote port the proxy is listening on for incoming connections (when using BIND).</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1640"></a>
Event: 'established'</h1>
<ul>
<li><code>info</code> { SocksClientEstablishedEvent } An object containing a Socket and SocksRemoteHost info.</li>
</ul>
<p>This event is emitted when the following conditions are met:</p><ol type="1">
<li>When using the CONNECT command, and a proxy connection has been established to the remote host.</li>
<li>When using the BIND command, and an incoming connection has been accepted by the proxy and a TCP relay has been established.</li>
<li>When using the ASSOCIATE command, and a UDP relay has been established.</li>
</ol>
<p>When using BIND, 'bound' is first emitted to indicate the SOCKS server is waiting for an incoming connection, and provides the remote port the SOCKS server is listening on.</p>
<p>When using ASSOCIATE, 'established' is emitted with the remote UDP port the SOCKS server is accepting UDP frame packets on.</p>
<p><b>SocksClientEstablishedEvent</b> </p><div class="fragment"><div class="line">{</div>
<div class="line">  socket: net.Socket, // The underlying raw Socket</div>
<div class="line">  remoteHost: {</div>
<div class="line">    host: &#39;1.2.3.4&#39;, // The remote host that is listening (usually the proxy itself)</div>
<div class="line">    port: 52738 // The remote port the proxy is listening on for incoming connections (when using BIND).</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1641"></a>
client.connect()</h1>
<p>Starts connecting to the remote SOCKS proxy server to establish a proxy connection to the destination host.</p>
<h1><a class="anchor" id="autotoc_md1642"></a>
client.socksClientOptions</h1>
<ul>
<li><code>returns</code> { SocksClientOptions } The options that were passed to the SocksClient.</li>
</ul>
<p>Gets the options that were passed to the SocksClient when it was created.</p>
<p><b>SocksClientError</b> </p><div class="fragment"><div class="line">{ // Subclassed from Error.</div>
<div class="line">  message: &#39;An error has occurred&#39;,</div>
<div class="line">  options: {</div>
<div class="line">    // SocksClientOptions</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1643"></a>
Further Reading:</h1>
<p>Please read the SOCKS 5 specifications for more information on how to use BIND and Associate. <a href="http://www.ietf.org/rfc/rfc1928.txt">http://www.ietf.org/rfc/rfc1928.txt</a></p>
<h1><a class="anchor" id="autotoc_md1644"></a>
License</h1>
<p>This work is licensed under the <a href="http://en.wikipedia.org/wiki/MIT_License">MIT license</a>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
		<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
			<ul>
				<li class="footer">
					Generated on Sun Apr 3 2022 12:33:25 for Engage Engine API by <a href="http://www.doxygen.org/index.html">
					<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.18.
					Dark theme by <a href="http://majerle.eu" target="_new">Tilen Majerle</a>. All rights reserved.
				</li>
			</ul>
		</div>
		<script src="custom.js"></script>
	</body>
</html>